---
title: "Assignment"
author: "Nguyen Hoang Nhat Linh"
date: "2025-11-23"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(knitr)
library(ggplot2) # this is primarly used to better visualise the visualisations
```

# Load Data

First of all, we begin by reading the datasets from its respective CSV files. Afterwards, we inspect on each datasets to see the total rows and columns. This allow us to know the original dataset characteristics.

```{r}
# Read csv files with the directory well set beforehand
engine <- read.csv("Engine.csv")
auto <- read.csv("Automobile.csv")
maint <- read.csv("Maintenance.csv")

# Inspect 'Engine'' data
print("Engines:")
str(engine)
summary(engine)
```

```{r}
# Inspect 'Automobile' data
print("Automobile:")
str(auto)
summary(auto)
```

```{r}
# Inspect 'Maintenance' data
print("Maintenance:")
str(maint)
summary(maint)
```

Using "str()", the overall structure of each datasets are well displayed.From the summaries above, we can see that the dataset overview can be seen as follow:

- **Engine**: 8 variables with 88 rows
- **Automobile**: 13 variables with 204 rows
- **Maintenance**: 7 variables with 374 rows 

This is the overall structure when run the datasets in R. From here, we would proceed to solve each tasks.


# Task 1:  

## 1.1: Write the code to inspect the data structure and present the data: The missing values in the dataset were written as "?", replace any "?" with NA; Write code to check: after replacing, how many rows were affected in total? Does this change alter the data distribution?

### Count "?" and replace it with "NA"

In R, the question mark **'?'** is not recognize by as a missing value. This could cause errors in statistical analysis. Therefore, by replacing **'?' to 'NA'** we can code to find out the missing values.

In this question, using the *"mutate()"* function with *"(across(where(is.character)))"*,we can scan all character columns and replace all the '?' to 'NA'.

```{r}
# Count "?" and replace it with "NA"
NA_replace <- function(df, name) {
  # Count rows with "?"
  rows_with_q <- df %>% 
    filter(if_any(everything(), ~ . == "?")) %>% 
    # counts total number of rows that contain at least one instance '?' (everything)
    nrow()
  
  # Replace "?" with NA
  df_clean <- df %>%
    mutate(across(where(is.character), ~na_if(., "?"))) 
  # scan all character columns and replace all the '?' to 'NA'
  
  print(paste("Number of rows affected in", name, ":", rows_with_q))
  return(df_clean)
}

# Apply cleaning
engines <- NA_replace(engine, "Engines")
autos <- NA_replace(auto, "Automobiles")
maint <- NA_replace(maint, "Maintenance")
```

In total, there are 6 rows being affected (all in 'Engine').

```{r}
# Total NA
print(paste("Total NAs in Engine:", sum(is.na(engines))))
print(paste("Total NAs in Automobile:", sum(is.na(autos))))
print(paste("Total NAs in Engine:", sum(is.na(maint))))
```

As we can see, there are 6 '?' and when we replace it, we end up with **34 NAs in total**.

Here, when we convert it to NA, we are simply marking the missing spots properly so R can handle them. All the real numbers and categories stays exactly the same, so the overall distribution of the dataset does not change.

## 1.2 Convert categorical variables BodyStyles, FuelTypes, ErrorCodes to factors
```{r}
# Convert categorical variables to factors

# Converting 'BodyStyles' from character to factor
autos$BodyStyles <- as.factor(autos$BodyStyles) 

# Converting 'FuelTypes' from character to factor
engines$FuelTypes <- as.factor(engines$FuelTypes) 

# Converting 'ErrorCodes' from character to factor
maint$ErrorCodes <- as.factor(maint$ErrorCodes) 
```

By using **"as.factor"** we transform the 'BodyStyles', 'FuelTypes', and 'ErrorCodes' from characters types to factors. This is to ensure the that variables are recognised as a factor rather than numbers or simple text. This way, R can read them correctly to group data when plotting and analysing.

## 1.3 Replace the missing values in column Horsepower with the median horsepower
```{r}
# Convert Horsepower to numeric
engines$Horsepower <- as.numeric(engines$Horsepower)

# This is just an extra step to make sure it is also numeric
engines$EngineSize <- as.numeric(engines$EngineSize)

# since the Horsepower column is numeric
hp_median <- median(engines$Horsepower, na.rm = TRUE)

# Replace NA with the median
engines <- engines %>%
  mutate(Horsepower = ifelse(is.na(Horsepower), hp_median, Horsepower)) 
# checks every row in the Horsepower column.
# If a value is missing "(is.na())", it replaces it with the calculated 'hp_median'
# otherwise it keeps the original value

print(paste("Missing Horsepower values remaining:", sum(is.na(engines$Horsepower))))
```

In this situation, 'Horsepower' is converted to numeric so calculations work. Then, imputing the missing values in 'Horsepower' column with **median** would offer a better better than using mean. As median is less sensitive to outliers than mean, making it a better option to chose considering the central tendency of this variable. 

Additionally, **"mutate()"** and **"ifelse()"** were used to select only the NAs to replace with the calculated "hp_median" above. This would eventually preserves the integrity of the existing data.

## 1.4 Select the appropriate chart type and display: horsepower distribution

```{r}
# Histogram for distribution 
ggplot(engines, aes(x = Horsepower)) +
  geom_histogram( # this creates a histogram
    binwidth = 10, fill = "skyblue", color = "black") +
  geom_vline(aes(xintercept = median(Horsepower)), color="red", linetype="dashed") +
  # the line above creates an abline that shows the median for 'Horsepower'
  labs(title = "Distribution of Engine Horsepower", # this is the name for the histogram
       subtitle = paste("Median Horsepower =", hp_median), # this adds a sub-title
       x = "Horsepower", y = "Count") + # names the x and y axis
  theme_minimal() # removes the default gray background
```
As the variable 'Horsepower' is a numeric variable, its distribution can be visualized using a histogram. The abline (red line) shows where the middle value is. This makes the shape and central tendency of horsepower becomes much easier to understand. Our red line here shows that the median horsepower is around 102.













