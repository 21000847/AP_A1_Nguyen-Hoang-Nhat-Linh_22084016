---
title: "Assignment"
author: "Nguyen Hoang Nhat Linh"
date: "2025-11-23"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(knitr)
library(ggplot2) # this is primarly used to better visualise the visualisations
```

# Load Data

First of all, we begin by reading the datasets from its respective CSV files. Afterwards, we inspect on each datasets to see the total rows and columns. This allow us to know the original dataset characteristics.

```{r}
# Read csv files with the directory well set beforehand
engine <- read.csv("Engine.csv")
auto <- read.csv("Automobile.csv")
maint <- read.csv("Maintenance.csv")

# Inspect 'Engine'' data
print("Engines:")
str(engine)
summary(engine)
```

```{r}
# Inspect 'Automobile' data
print("Automobile:")
str(auto)
summary(auto)
```

```{r}
# Inspect 'Maintenance' data
print("Maintenance:")
str(maint)
summary(maint)
```

Using "str()", the overall structure of each datasets are well displayed.From the summaries above, we can see that the dataset overview can be seen as follow:

- **Engine**: 8 variables with 88 rows
- **Automobile**: 13 variables with 204 rows
- **Maintenance**: 7 variables with 374 rows 

This is the overall structure when run the datasets in R. From here, we would proceed to solve each tasks.


# Task 1:  

## 1.1: Write the code to inspect the data structure and present the data: The missing values in the dataset were written as "?", replace any "?" with NA; Write code to check: after replacing, how many rows were affected in total? Does this change alter the data distribution?

### Count "?" and replace it with "NA"

In R, the question mark **'?'** is not recognize by as a missing value. This could cause errors in statistical analysis. Therefore, by replacing **'?' to 'NA'** we can code to find out the missing values.

In this question, using the *"mutate()"* function with *"(across(where(is.character)))"*,we can scan all character columns and replace all the '?' to 'NA'.

```{r}
# Count "?" and replace it with "NA"
NA_replace <- function(df, name) {
  # Count rows with "?"
  rows_with_q <- df %>% 
    filter(if_any(everything(), ~ . == "?")) %>% 
    # counts total number of rows that contain at least one instance '?' (everything)
    nrow()
  
  # Replace "?" with NA
  df_clean <- df %>%
    mutate(across(where(is.character), ~na_if(., "?"))) 
  # scan all character columns and replace all the '?' to 'NA'
  
  print(paste("Number of rows affected in", name, ":", rows_with_q))
  return(df_clean)
}

# Apply cleaning
engines <- NA_replace(engine, "Engines")
autos <- NA_replace(auto, "Automobiles")
maint <- NA_replace(maint, "Maintenance")
```

In total, there are 6 rows being affected (all in 'Engine').

```{r}
# Total NA
print(paste("Total NAs in Engine:", sum(is.na(engines))))
print(paste("Total NAs in Automobile:", sum(is.na(autos))))
print(paste("Total NAs in Engine:", sum(is.na(maint))))
```

As we can see, there are 6 '?' and when we replace it, we end up with **34 NAs in total**.

Here, when we convert it to NA, we are simply marking the missing spots properly so R can handle them. All the real numbers and categories stays exactly the same, so the overall distribution of the dataset does not change.

## 1.2 Convert categorical variables BodyStyles, FuelTypes, ErrorCodes to factors
```{r}
# Convert categorical variables to factors

# Converting 'BodyStyles' from character to factor
autos$BodyStyles <- as.factor(autos$BodyStyles) 

# Converting 'FuelTypes' from character to factor
engines$FuelTypes <- as.factor(engines$FuelTypes) 

# Converting 'ErrorCodes' from character to factor
maint$ErrorCodes <- as.factor(maint$ErrorCodes) 
```

By using **"as.factor"** we transform the 'BodyStyles', 'FuelTypes', and 'ErrorCodes' from characters types to factors. This is to ensure the that variables are recognised as a factor rather than numbers or simple text. This way, R can read them correctly to group data when plotting and analysing.

## 1.3 Replace the missing values in column Horsepower with the median horsepower
```{r}
# Convert Horsepower to numeric
engines$Horsepower <- as.numeric(engines$Horsepower)

# This is just an extra step to make sure it is also numeric
engines$EngineSize <- as.numeric(engines$EngineSize)

# since the Horsepower column is numeric
hp_median <- median(engines$Horsepower, na.rm = TRUE)

# Replace NA with the median
engines <- engines %>%
  mutate(Horsepower = ifelse(is.na(Horsepower), hp_median, Horsepower)) 
# checks every row in the Horsepower column.
# If a value is missing "(is.na())", it replaces it with the calculated 'hp_median'
# otherwise it keeps the original value

print(paste("Missing Horsepower values remaining:", sum(is.na(engines$Horsepower))))
```

In this situation, 'Horsepower' is converted to numeric so calculations work. Then, imputing the missing values in 'Horsepower' column with **median** would offer a better better than using mean. As median is less sensitive to outliers than mean, making it a better option to chose considering the central tendency of this variable. 

Additionally, **"mutate()"** and **"ifelse()"** were used to select only the NAs to replace with the calculated "hp_median" above. This would eventually preserves the integrity of the existing data.

## 1.4 Select the appropriate chart type and display: horsepower distribution

```{r}
# Histogram for distribution 
ggplot(engines, aes(x = Horsepower)) +
  geom_histogram( # this creates a histogram
    binwidth = 10, fill = "skyblue", color = "black") +
  geom_vline(aes(xintercept = median(Horsepower)), color="red", linetype="dashed") +
  # the line above creates an abline that shows the median for 'Horsepower'
  labs(title = "Distribution of Engine Horsepower", # this is the name for the histogram
       subtitle = paste("Median Horsepower =", hp_median), # this adds a sub-title
       x = "Horsepower", y = "Count") + # names the x and y axis
  theme_minimal() # removes the default gray background
```
As the variable 'Horsepower' is a numeric variable, its distribution can be visualized using a histogram. The abline (red line) shows where the middle value is. This makes the shape and central tendency of horsepower becomes much easier to understand. Our red line here shows that the median horsepower is around 102.

# Task 2: 

## 2.1 The code to analyse the distribution of the horsepower across the engine types.

Here, we would want to see the 'Horsepower' (a numeric variable) and we would want to see it across engine categories (in our case is Engine Types).

A boxplot would show the median, this helps us to quickly identify patterns, such as which engine types are generally more powerful or more consistent in their performance. Most importantly, it shows the overall spread of horsepower values, and any extreme points that stand out as outliers. 

Therefore, employing a box plot would allow us to have a clearer understanding of how horsepower is distributed across the different engine designs.

```{r}
# To use boxplots to analyse the distribution and 
# compare continuous variable (in our case, horsepower) across multiple categories.

ggplot(engines, aes(x = EngineType, y = Horsepower, fill = EngineType)) + # this defines the x and y
  geom_boxplot() + # this creates a box plot
  labs(title = "Horsepower Distribution by Engine Type", # title for the box plot
       x = "Engine Type", y = "Horsepower") + # this names the x and y axis
  theme_minimal() + # removes the default gray background
  # the one below rotates the labels 45 degrees to prevent overlapping
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) 
```

From the boxplot above, we can see that two 'dohc' (red) and 'ohcv' (blue) generally produces a higher median horsepower compared to other types. However, the 'ohc' (green) shows a great range of horsepower.
 
We can easily spot several outliers that indicates an "irregular" in what is generally shown. For instance, while most 'ohc' (pink) engines are low-power, some specific models have much higher output.

# 2.2 Write the code to investigate the distribution of the horsepower across the groups of the engine sizes (e.g., 60-90, 91-190, 191-299, 300+). Henceforth, visualise the findings.

To know the distribution of horsepower across groups of engines sizes, we will need to create bins that represent each groups (60-90, 91-190, 191-299, 300+). Here, we know that 'EngineSize' is a continuous variable. 

To create bins, the function **"mutate()"** was used to create a new column 'SizeGroup' and **"cut()"** was used to categorize rows base on their 'EngineSize' variable.

```{r}
# Create bins: 60-90, 91-190, 191-299, 300+
engines <- engines %>%
  mutate(SizeGroup # create a new column 'SizeGroup'
         = cut(EngineSize, # categorize rows base on their 'EngineSize'
                         breaks = c(59, 90, 190, 299, Inf), 
                         labels = c("60-90", "91-190", "191-299", "300+")))


# Visualisations
ggplot(engines, aes(x = Horsepower, fill = SizeGroup)) + # defines the x and y axis
  geom_histogram( # Creates a histogram
    binwidth = 15, color = "black", alpha = 0.7) + 
  # groups horsepower into bins 15 units wide, black colored with 0.7 opacity
  facet_wrap(~SizeGroup, scales = "free_y") + 
  # splits the single chart into separate mini-charts for each 'SizeGroup'
  labs(title = "Horsepower Distribution by Engine Size Group", # chart's title
       x = "Horsepower", y = "Frequency") +  # this names the x and y axis
  theme_minimal() # removes the default gray background

```

We generally expect a positive correlation such as larger engine size groups (300+), should correlate with the higher horsepower ranges in the histogram.

Here, the histogram confirms it. We can see a positive correlation between engine sizes and horsepower as follow:

- **Small engines (60-90)** and **(91-190)**: Strictly concentrated at the lower end of the horsepower scale.

- **Medium engines (191-299)**: Interestingly, while most fall in the average range, some outliers does shows the highest horsepower.

- **Large engines (300+)**: Here, it is reasonable when large engines fall mostly in high horsepower ranges. However, the distribution only falls in 2 specific level of horsepower.

As we can observe, most of the times the larger the engines the horsepower would be higher as well. However, some outliers (special cases) would offer a different horsepower outcome. This also means that, not all engine size larger than 300+ would bring back the best 'Horsepower' range.








